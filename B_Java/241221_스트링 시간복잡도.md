# 자바의 문자열 합 연산과 `StringBuilder`의 메모리/시간복잡도

## 개요

자바에서 **문자열(String)**은 **불변(Immutable)** 객체로 설계되어 있습니다. 이 특성으로 인해 단순한 문자열 합(+) 연산이 반복될 경우 **메모리 사용량 증가**와 **성능 저하**가 발생할 수 있습니다. 이를 개선하기 위해 자바에서는 **`StringBuilder`**(또는 멀티스레드 환경에서는 `StringBuffer`)를 사용하여 문자열을 효율적으로 연결합니다.

이 문서에서는 문자열 합 연산 시 메모리가 어떻게 동작하는지, 그리고 `StringBuilder`의 `append` 메서드가 어떠한 시간복잡도를 갖는지 설명합니다.

---

## 1. 문자열 합(+) 연산 시 메모리 동작

### 1.1 문자열은 불변(Immutable)

```java
String str = "Hello";
str = str + " World"; 
```

자바에서 `String` 객체는 **불변**이므로, `str = str + " World";`와 같은 연산을 수행할 때마다 **새로운 문자열 객체**가 생성됩니다.

- `"Hello"`는 기존 객체
- `" World"`를 더한 결과인 `"Hello World"`는 새로운 객체로 생성

따라서,

```java
String result = "";
for (int i = 0; i < 10000; i++) {
    result = result + i; 
}
```

위 코드처럼 반복문 내에서 문자열을 계속 더하면 매 반복마다 새로운 `String` 객체가 생성되어 **메모리를 많이 사용**하고 **성능이 저하**됩니다.

#### 메모리 동작 개념
- 기존 문자열 `result`의 복사본을 만들고, 새로 붙일 문자열을 결합 → 새 문자열 객체 생성
- 반복될수록 객체 생성 횟수가 증가

---

## 2. `StringBuilder`를 사용한 문자열 연결

### 2.1 `StringBuilder` 내부 구조

```java
StringBuilder sb = new StringBuilder();
for (int i = 0; i < 10000; i++) {
    sb.append(i);
}
String result = sb.toString();
```

- `StringBuilder`는 **가변(Mutable) 배열(버퍼)**을 사용하여 문자열을 관리합니다.
- `.append()` 메서드를 통해 새 문자열을 붙일 때마다, 내부 버퍼에 **추가**만 합니다.
- 필요하다면 버퍼 크기를 자동으로 확장하되, **매번 새로운 객체**를 생성하지 않습니다.

### 2.2 시간 복잡도

1. **`String` 반복 연결**
    - 불변 문자열이므로 매번 새로운 문자열 객체가 생성 → **O(n^2)** 시간 복잡도 (n은 전체 문자열 길이)
    - 예: `for` 루프에서 n번 연결할 때, 각 연결마다 길이에 비례한 복사가 일어남

2. **`StringBuilder` `.append()`**
    - 내부 버퍼에 이어 붙이는 방식 → 평균적으로 **O(1)**(**Amortized O(1)**)
    - 버퍼가 가득 찼을 때만 크기 확장(re-allocation) 과정이 발생하지만, 이는 상수 배 확장으로 처리되어 전체적으로 **상황에 따라 O(n)**일 수 있으나 평균적인 시나리오에서는 **O(1)**로 평가

#### 예시
- 10,000번 반복하여 문자열을 연결해야 할 경우:
    - `String`만 사용 → O(n^2)으로 인한 매우 큰 오버헤드
    - `StringBuilder` → 대부분의 상황에서 **O(n)** (또는 각 `.append()` 호출은 평균적으로 O(1)이라고 봄)

---

## 3. 정리

1. **문자열 합(+) 연산**
    - 불변 문자열 특성으로 매번 새로운 객체 생성
    - 메모리 사용량 증가, 시간 복잡도 **O(n^2)**
    - 반복문 안에서 사용 시 성능 심각 저하

2. **`StringBuilder`**
    - 내부 버퍼를 사용해 문자열을 가변적으로 관리
    - `.append()` → **평균 O(1)** 연산, 전체 반복 시 **O(n)**에 수렴
    - 반복적인 문자열 연결 작업에 유리

---

## 결론

- **문자열 합 연산(+)**을 반복해서 사용할 경우, 메모리 및 성능 문제 발생
    - 불변 문자열로 인해 매번 새로운 문자열 객체 생성
    - 시간 복잡도는 O(n^2)에 가까워짐
- **`StringBuilder`**의 `.append()` 메서드를 사용하면,
    - 내부 버퍼로 작업하므로 메모리 사용량과 성능을 최적화
    - 평균적으로 **O(1)**의 시간에 문자열 결합 가능

따라서 대량의 문자열을 반복 연결해야 하는 상황에서는 `StringBuilder`(또는 스레드 안전이 필요하다면 `StringBuffer`)를 사용하는 것이 권장됩니다.
